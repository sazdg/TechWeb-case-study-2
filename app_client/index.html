<!DOCTYPE html>
<html>
    <head>
        <title>PHP case study 2</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="case study #2" />
        <meta name="author" content="saz" />
        <link rel="stylesheet" href="./stile/stile.css">
        <!--JQuery CDN-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <script>
            /*chiamate ajax che rimandano ai file api
            chiamate get, post, put, delete
            $.ajax
            .done
            .fail
            */

            $(document).ready(function(){
                $("#click").on("click", function(){
                    $.ajax({
                        url:"../api_server/api/read.php",
                        type:"GET",
                        dataType:'json'
                    })
                    .done(function(response){
                        var lista = "<ul>";
                            for(let i = 0; i < response.products.length; i++){
                                var id = response.products[i].id;
                                var nome = response.products[i].name;
                                var prezzo = response.products[i].price;
                                lista += "<li>" + id + " " + nome + " " + prezzo + "</li>";
                            }
                        lista += "</ul>";
                        $("#AllProducts").html(lista);
                    })
                    .fail(function(xhr, resp, text){
                        console.log(xhr, resp, text);
                        $("#AllProducts").html(xhr+resp+text);
                    });
                    return false;//necessario per far funzionare on click
                });
                
            });
        </script>
    </head>

    <body>
        <p id="title">TECH WEB - CASE STUDY #2</p>
        <br/>
        <span>
            Descrizione negozio di fumetti tipo: <br/>
            <strong>backend</strong>=> i dati del database, 
            i servizi sono nella cartella api (create, delete, read, read.one, update, search)
            <br/>
            <strong>frontend</strong> => index

        </span>
        <div>
            <span id="AllProducts">
                Elenco di tutti i prodotti:
            </span>
            <a href="#" id="click"> Clicca per vedere</a><br/>
        </div>
        <div>
            <form action="../api_server/api/test.php" method="get">
                <span>database test -> </span>
                <input type="submit" value="prova">
            </form>
        </div>
        <div>
            <form action="../api_server/api/create.php" method="get">
                <span>add new item -> </span>
                <br/>
                <span>nome:</span>
                <input type="text" name="new_item"><br/>
                <span>descrizione:</span>
                <input type="text" name="descrizione"><br />
                <span>il prezzo Ã¨ un numero o un testo?:</span>
                <input type="text" name="prezzo"><br />
                <span>categoria id: 1(tex) 2(dylan dog) 3(topolino):</span>
                <input type="text" name="cat_id"><br /><br/>

                <input type="submit" value="Aggiugi">
            </form>
        </div>
        <br/>
        <div>
            <form action="../api_server/api/update.php" method="get">
                <span>Scegli id del prodotto da cambiare:</span>
                <input type="text" name="id_vecchio"><br/>
                <span>Scegli il nuovo nome del prodotto:</span>
                <input type="text" name="nome_nuovo"><br/>
                <input type="submit" value="Aggiorna">
            </form>
        </div>
    </body>
</html>